<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<!--res.layui.com/layui/dist/css/layui.css-->
<!--//res.layui.com/layui/dist/layui.js-->
<script src="../js/jquery-1.9.1.min.js"></script>
<link rel="stylesheet" href="../js/layui/css/layui.css"  media="all">
<link rel="stylesheet" href="../js/layui/css/layui.css" />
<link rel="stylesheet" href="../js/layui/css/modules/laydate/default/laydate.css">

<script type="text/javascript" src="../js/layui/layui.js"></script>
<script src="../js/layui/layui.all.js" charset="UTF-8"></script>


<body>
<form class="layui-form" id="formid">
    <div class="layui-form-item">
        <label class="layui-form-label">出发地</label>
        <div class="layui-input-inline">
            <input type="text" name="origin"  id="originid" style="padding:-3px;margin-bottom: -3px" lay-verify="required" placeholder="请选择发货地" autocomplete="off" class="layui-input" onclick="gethidden()">
            <div class="layui-tab" id="divid" lay-filter="test1"  style="width: 500px;height: 500px;padding:-3px;margin-top: -5px" hidden>
                <ul class="layui-tab-title">
                    <li lay-id="222"><a href="javascript:getoftencity()">常用</a></li>
                    <li lay-id="333"><a href="javascript:getprovinces()">省份</a></li>
                    <li lay-id="444"><a href="javascript:void(0)" >城市</a></li>
                    <li lay-id="555"><a href="javascript:void(0)">县区</a></li>
                </ul>
                <div class="layui-tab-content">
                    <div class="layui-tab-item"><span id="oftencityid"></span></div>
                    <div class="layui-tab-item"><span id="provincesid"></span></div>
                    <div class="layui-tab-item"><span id="cityid"></span></div>
                    <div class="layui-tab-item"><span id="countyid"></span></div>
                </div>
            </div>
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">始发地</label>
        <div class="layui-input-inline">
            <input type="text" name="provenance" id="provenanceid" style="padding:-3px;margin-bottom: -3px" lay-verify="required" placeholder="请选择发货地" autocomplete="off" class="layui-input" onclick="gethidden2()">
            <div class="layui-tab" id="divid2" lay-filter="test2"  style="width: 500px;height: 500px;padding:-3px;margin-top: -5px" hidden>
                <ul class="layui-tab-title">
                    <li lay-id="22"><a href="javascript:getoftencity2()">常用</a></li>
                    <li lay-id="33"><a href="javascript:getprovinces2()">省份</a></li>
                    <li lay-id="44"><a href="javascript:void(0)" >城市</a></li>
                    <li lay-id="55"><a href="javascript:void(0)">县区</a></li>
                </ul>
                <div class="layui-tab-content">
                    <div class="layui-tab-item"><span id="oftencityid2"></span></div>
                    <div class="layui-tab-item"><span id="provincesid2"></span></div>
                    <div class="layui-tab-item"><span id="cityid2"></span></div>
                    <div class="layui-tab-item"><span id="countyid2"></span></div>
                </div>
            </div>
        </div>
    </div>


    <div class="layui-form-item">
    <label class="layui-form-label">联系人</label>
    <div class="layui-input-inline">
        <input type="text" name="contact"   lay-verify="required" placeholder="请输入联系人" autocomplete="off" class="layui-input">
    </div>
</div>

    <div class="layui-form-item">
        <label class="layui-form-label">手机号</label>
        <div class="layui-input-inline">
            <input type="text" name="phone"   lay-verify="required" placeholder="请输入手机号" autocomplete="off" class="layui-input" >
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">货物名称</label>
        <div class="layui-input-inline">
            <input type="text" name="nameCommodity"   lay-verify="required" placeholder="请输入货物名称" autocomplete="off" class="layui-input" >
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">货物信息</label>
        <div class="layui-input-inline">
            <input type="text" name="cargoInformation"   lay-verify="required" placeholder="请输入货物重量" autocomplete="off" class="layui-input" >
        </div>
    </div>

</form>
<button class="layui-btn layui-btn-primary layui-btn-radius" onclick="tocarriers()">选择承运商</button>
</body>
<script type="text/javascript">


function gethidden(){
var divid=$("#divid");
    divid.prop("hidden","");
}
function gethidden2(){
    var divid=$("#divid2");
    divid.prop("hidden","");
}
/*layui.use('element', function(){
    var $ = layui.jquery
        ,element = layui.element; //Tab的切换功能，切换事件监听等，需要依赖element模块
})*/
//获取hash来切换选项卡，假设当前地址的hash为lay-id对应的值


/*//监听Tab切换，以改变地址hash值
element.on('tab(test1)', function(){
    location.hash = 'test1='+ this.getAttribute('lay-id');
});*/


    function getprovinces(){
    $.ajax({
        url:"../ant/getprovinces",
        type:"post",
        success:function(data){
            var htm="";
            for (var i=0;i<data.rows.length;i++){
                htm+="<a href='javascript:getcity("+data.rows[i].id+",&quot;"+data.rows[i].name+"&quot;)'>&nbsp;"+data.rows[i].name+" &nbsp;</a>";
                $("#provincesid").html(htm);
            }

        },error:function(){
            alert("请重新选中，网络开小差");
        }
    })
}

function getcity(cid,cname){
    var htm="";
    //var layid = location.hash.replace(/^#test1=/, '333');
    layui.element.tabChange('test1','444'); //假设当前地址为：http://a.com#test1=222，那么选项卡会自动切换到“发送消息”这一项
    $.ajax({
        url:"../ant/getcity",
        data:{cid:cid,cname:cname},
        type:"post",
        success:function(data){
            for (var i=0;i<data.rows.length;i++){
                htm+="<a href='javascript:getcounty("+data.rows[i].id+",&quot;"+cname+"&quot;,&quot;"+data.rows[i].name+"&quot;)'>&nbsp;"+data.rows[i].name+" &nbsp;</a>";
                $("#cityid").html(htm);
            }
        },error:function(){
            alert("请重新选中，网络开小差");
        }

    })
}


function getcounty(cid,cname,ctname){
    var htm="";
    //var layid = location.hash.replace(/^#test1=/, '333');
    layui.element.tabChange('test1','555'); //假设当前地址为：http://a.com#test1=222，那么选项卡会自动切换到“发送消息”这一项
    $.ajax({
        url:"../ant/getcounty",
        data:{cid:cid},
        type:"post",
        success:function(data){
            for (var i=0;i<data.rows.length;i++){
                htm+="<a href='javascript:sethidden(&quot;"+cname+"&quot;,&quot;"+ctname+"&quot;,&quot;"+data.rows[i].name+"&quot;)'>&nbsp;"+data.rows[i].name+" &nbsp;</a>";
                $("#countyid").html(htm);
            }
        },error:function(){
            alert("请重新选中，网络开小差");
        }

    })
}
function sethidden(cname,ctname,xname){
       //alert(cname+"-"+ctname+"-"+xname);
        var str=cname+"-"+ctname+"-"+xname;
    $("#originid").val(str);
    var divid=$("#divid");
    divid.prop("style","display:none");

}


function getprovinces2(){
    $.ajax({
        url:"../ant/getprovinces",
        type:"post",
        success:function(data){
            var htm="";
            for (var i=0;i<data.rows.length;i++){
                htm+="<a href='javascript:getcity2("+data.rows[i].id+",&quot;"+data.rows[i].name+"&quot;)'>&nbsp;"+data.rows[i].name+" &nbsp;</a>";
                $("#provincesid2").html(htm);
            }

        },error:function(){
            alert("请重新选中，网络开小差");
        }
    })
}

function getcity2(cid,cname){
    var htm="";
    //var layid = location.hash.replace(/^#test1=/, '333');
    layui.element.tabChange('test2','44'); //假设当前地址为：http://a.com#test1=222，那么选项卡会自动切换到“发送消息”这一项
    $.ajax({
        url:"../ant/getcity",
        data:{cid:cid,cname:cname},
        type:"post",
        success:function(data){
            for (var i=0;i<data.rows.length;i++){
                htm+="<a href='javascript:getcounty2("+data.rows[i].id+",&quot;"+cname+"&quot;,&quot;"+data.rows[i].name+"&quot;)'>&nbsp;"+data.rows[i].name+" &nbsp;</a>";
                $("#cityid2").html(htm);
            }
        },error:function(){
            alert("请重新选中，网络开小差");
        }

    })
}
function getcounty2(cid,cname,ctname){
    var htm="";
    //var layid = location.hash.replace(/^#test1=/, '333');
    layui.element.tabChange('test2','55'); //假设当前地址为：http://a.com#test1=222，那么选项卡会自动切换到“发送消息”这一项
    $.ajax({
        url:"../ant/getcounty",
        data:{cid:cid},
        type:"post",
        success:function(data){
            for (var i=0;i<data.rows.length;i++){
                htm+="<a href='javascript:sethidden2(&quot;"+cname+"&quot;,&quot;"+ctname+"&quot;,&quot;"+data.rows[i].name+"&quot;)'>&nbsp;"+data.rows[i].name+" &nbsp;</a>";
                $("#countyid2").html(htm);
            }
        },error:function(){
            alert("请重新选中，网络开小差");
        }

    })
}
function sethidden2(cname,ctname,xname){
    var str=cname+"-"+ctname+"-"+xname;
    $("#provenanceid").val(str);
    var divid=$("#divid2");
    divid.prop("style","display:none");
}
//常用有问题 记得修改
function getoftencity(){
    $.ajax({
        url:"../ant/getoftencity",
        type:"post",
        success:function(data){
                var htm="";
                for (var i=0;i<data.rows.length;i++){
                    htm+="<a href='javascript:void(0)'>&nbsp;"+data.rows[i].name+" &nbsp;</a>";
                    $("#oftencityid").html(htm);
                }

        },error:function(){
            alert("请重新选中，网络开小差");
        }
    })
}
function getoftencity2(){
    var htm="";
    $.ajax({
        url:"../ant/getoftencity",
        type:"post",
        success:function(data){
            var htm="";
            for (var i=0;i<data.rows.length;i++) {
                htm += "<a href='javascript:void(0)'>&nbsp;" + data.rows[i].name + " &nbsp;</a>";
                $("#oftencityid").html(htm);
            }
        },error:function(){
            alert("请重新选中，网络开小差");
        }

    })
}
function tocarriers(){
    var formdata=$("#formid").serialize();
    diaLogOne("../ant/page?formdata="+formdata);

}
function diaLogOne(HTMLurl){

    layer.open({
        title:"选择承运商",
        content: getJspHtml(HTMLurl),
    });
    $("#addid").prop("style","");

}

// 新增   发送ajax请求获取jsp页面内容
function getJspHtml(HTMLurl){
    //alert("getJspHtml(HTMLurl)查看详情的--------------"+HTMLurl);
    var  jspHtml = "";
    $.ajax({
        url :HTMLurl,// 弹框里是：  /test/project/addPage.do
        type : "post",
        async:false,//需要注意的   应是同步请求
        success : function (data){
            //返回的data为     bootstarpDialog.jsp  的页面内容
            //alert("getJspHtml(HTMLurl)------"+data);
            jspHtml = data;
        },error : function (){
            alert("ajax失败");
        }
    })
    //将data返回的jsp内容  填充到dialog方法的   message  属性中
    return jspHtml;
}

function add(){
    var formdata=$("#formid")
    alert(formdata);
    $.ajax({
        url:'../ant/addsubmit',
        type:'post',
        data:formdata,
        dataType:'json',
        success:function(){
            alert("新增成功");
        },error:function(){
            alert("新增失败");
    }
    });
}


</script>
</html>